## O Que e uma Encaminhamento de Porta (*Port Forwarding*)?
&nbsp;SSH *port forwarding* e um mecanismo para atrelar portas de aplicacoes da maquina do *client* para a maquina do *server*, e vice versa.

&nbsp;Pode ser usado para encriptar aplicacoes antigas, atravesar *firewalls*, e alguns administradores de sistema e profissionais de IT o usam para abrir *backdoors* na rede interna das proprias maquinas.

Mais informacoes em [SSH Tunneling](https://www.ssh.com/academy/ssh/tunneling).


## Encaminhamento Local (*Local Forwarding*).
&nbsp;O *Local Forwarding* e usado para encaminhar uma porta do computador do *client* para a maquina do servidor.
Basicamente o SSH *client* procura conexoes em uma porta configurada, e quando recebe a conexao, ela atrela a conexao a um servidor SSH.

&nbsp;O servidor conecta a uma porta de destino configurada, possivelmente em uma maquina diferente do servidor SSH.

&nbsp;No [OpenSSH](), o encaminhamento de porta local e configurado usando a opcao `-L`.

<details><summary><b><i>Local Forwarding</i></b></summary>

>&nbsp;`ssh -L 80:intra.example.com:80 gw.example.com`
>
>&nbsp;O exemplo acima abre uma conexao para o *[jump server]()* **gw.example.com** e encaminha qualquer conexao para o **"*port* 80"** na maquina local para o **"*port* 80"** em **intra.example.com**.
>
>&nbsp;Por padrao, qualquer usuario (ate mesmo em uma maquina diferente) pode se conectar a porta especificada na maquina *SSH client*. Porem, pode-se restringir isso a programas no mesmo host provendo um **"*bind adress*"**:
>
>&nbsp;`ssh -L 127.0.0.1:80:intra.example.com:80 gw.example.com`
>

</details>

>[!NOTE]
>
>A opcao **"*LocalForward*"** no [arquivo de configuracao do *client* OpenSSH]() pode ser usada para configurar um encaminhamento sem ter que o especificar na linha de comando.

## Encaminhamento Remoto (*Remote Forwarding*).


&nbsp;No [OpenSSH](), o encaminhamento de porta remoto e configurado usando a opcao `-R`:

<details><summary><b><i>Remote Forwarding</i></b></summary>

>&nbsp;`ssh -R 8080:localhost:80 public.example.com`
>
>&nbsp;O *Remote Forwarding* acima permite que qualquer usuario no servidor remoto se conecte a **"*TCP port* 8080"** no servidor remoto. A conexao sera entao atrelada de volta ao *host* do *client*, e o *client* ira fazer uma conexao TCP a **"*port* 80"** no **"*localhost*"**. Qualquer nome de *host* ou endereco IP pode ser usado no lugar do *localhost* para especificar a qual host se conectar.
>
> [!IMPORTANT]
>&nbsp;Esse exemplo em particular seria util para dar a alguem de fora acesso a um servidor na rede interna. Ou para expor uma aplicacao na rede interna para a *internet* publica. Isso pode ser feito por um empregado em trabalho remoto, ou por um *hacker*.

</details>
